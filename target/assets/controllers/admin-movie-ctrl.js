streamaApp.controller("adminMovieCtrl",["$scope","apiService","$stateParams","modalService","$state","uploadService",function(a,d,b,c,e,g){a.loading=!0;d.movie.get(b.movieId).success(function(f){a.movie=f;a.loading=!1;a.highlightOnDashboard=c.newReleaseModal.bind(c,a.movie,"movie")});a.openMovieModal=function(){c.movieModal(a.movie,function(f){angular.merge(a.movie,f)})};a.delete=function(){alertify.set({buttonReverse:!0,labels:{ok:"Yes",cancel:"Cancel"}});alertify.confirm("Are you sure you want to delete this Movie?",
function(a){a&&d.movie.delete(b.movieId).success(function(){e.go("admin.movies")})})};a.addToCurrentNotification=function(){d.notification.addMovieToCurrentNotification(b.movieId).success(function(){alertify.set({buttonReverse:!0,labels:{ok:"Yes",cancel:"No"}});alertify.confirm("The movie was added to the current notification queue. Would you like to send it?",function(a){a?(d.notification.sendCurrentNotifcation(),alertify.success("Notification sent.")):alertify.success("The movie was added to the current notification queue.")})})};
a.deleteMovie=function(a){alertify.set({buttonReverse:!0,labels:{ok:"Yes",cancel:"Cancel"}});alertify.confirm("Are you sure, you want to delete this Movie?",function(b){b&&d.movie.delete(a.id).success(function(){e.go("admin.movies");$uibModalInstance.dismiss("cancel")})})};a.manageFiles=function(a){c.fileManagerModal(a)};a.addSimilarMovieToStreama=function(a,b){alertify.set({buttonReverse:!0,labels:{ok:"Yes",cancel:"Cancel"}});alertify.confirm('Do you want to add "'+a.title+'" to the Streama library?',
function(c){c&&(c=a.id,delete a.id,a.apiId=c,d.movie.save(a).success(function(a){b&&e.go("admin.movie",{movieId:a.id})}))})};a.uploadStatus={};a.upload=g.doUpload.bind(g,a.uploadStatus,"video/uploadFile.json?id="+b.movieId,function(b){a.uploadStatus.percentage=null;a.movie.files=a.movie.files||[];a.movie.files.push(b)})}]);