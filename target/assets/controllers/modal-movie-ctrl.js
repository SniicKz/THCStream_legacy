streamaApp.controller("modalMovieCtrl",["$scope","$uibModalInstance","apiService","movie","$state","uploadService",function(a,e,c,f,h,g){a.loading=!1;a.movie=f||{};a.saveMovie=function(a){c.movie.save(a).success(function(a){e.close(a);alertify.success("Movie saved.")})};a.toggleAddManually=function(){a.addManually=!a.addManually};a.selectFromAPI=function(b){console.log("%c selectFromAPI","color: deeppink; font-weight: bold; text-shadow: 0 0 5px deeppink;");var d=b.id;delete b.id;a.movie=b;a.movie.apiId=
d;a.formVisible=!0};a.search=function(a){return c.theMovieDb.search("movie",a).then(function(a){return a.data})};a.imageUpload={};a.uploadImage=function(b,c){g.doUpload(a.imageUpload,"file/upload.json",function(b){a.imageUpload.percentage=null;a.movie[c]=b;a.movie[c+"_src"]=b.src},b)};a.onTagSelect=function(b){c.tag.save(b);c.movie.save(a.movie)};a.tagTransform=function(a){return{name:a,isNew:!0}};a.deleteTag=function(b){alertify.set({buttonReverse:!0,labels:{ok:"Yes",cancel:"Cancel"}});alertify.confirm("Are you sure you want to delete the tag "+
b.name,function(d){d&&c.tag.delete(b.id).success(function(){_.remove(a.tags,{id:b.id})})})};c.tag.list().success(function(b){a.tags=b});setTimeout(function(){$(".name-input").focus()},200);a.cancel=function(){e.dismiss("cancel")}}]);