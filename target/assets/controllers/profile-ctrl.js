streamaApp.controller("profileCtrl",["$scope","apiService","$rootScope","userService",function(a,c,d,e){a.user=angular.copy(d.currentUser);a.loading=!0;a.passwordData={};a.passwordsInvalid=!0;a.languages=!0;c.theMovieDb.availableGenres().success(function(b){a.availableGenres=b;a.loading=!1});a.toggleSelectGenre=function(b){_.find(a.user.favoriteGenres,{apiId:b.apiId})?_.remove(a.user.favoriteGenres,{apiId:b.apiId}):a.user.favoriteGenres.push(b)};a.isGenreSelected=function(b){return _.find(a.user.favoriteGenres,
{apiId:b.apiId})};a.saveProfile=function(){a.loading=!0;c.user.saveProfile(a.user).success(function(b){a.loading=!1;e.setCurrentUser(b);alertify.success("Your profile was successfully saved.");a.profileForm.$setPristine()}).error(function(){a.loading=!1})};a.toggleChangePassword=function(){a.changePasswordIsActive=!a.changePasswordIsActive};a.validatePasswords=function(){a.passwordsInvalid=a.passwordData.newPassword!=a.passwordData.repeatPassword||6>a.passwordData.newPassword.length?!0:!1};a.saveNewPassword=
function(){a.loading=!0;c.user.changePassword(a.passwordData).success(function(){alertify.success("Password was successfully changed.");a.passwordData={};a.passwordsInvalid=!0;a.toggleChangePassword();a.loading=!1}).error(function(b){alertify.error(b.message);a.loading=!1})}}]);